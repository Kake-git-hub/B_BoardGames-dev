:root{
  --bg:#0b0f14;
  --card:#111826;
  --text:#e8eef7;
  --muted:#a8b3c6;
  --line:#223047;
  --accent:#4da3ff;
  --danger:#ff5a6a;
  --ok:#35d07f;
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans JP",sans-serif;
}
.app{max-width:520px;margin:0 auto;padding:16px}
.header{padding:8px 4px 12px}
.header-row{display:flex;justify-content:space-between;gap:12px;align-items:flex-start}
.header h1{margin:0;font-size:22px}
.sub{margin:6px 0 0;color:var(--muted);font-size:13px}
.rules-btn{white-space:nowrap}
.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:12px;
  padding:14px;
}
.row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.stack{display:flex;flex-direction:column;gap:10px}
.field{display:flex;flex-direction:column;gap:6px}
label{font-size:13px;color:var(--muted)}
input,select,button,textarea,a.btn{
  font:inherit;
  padding:10px 10px;
  border-radius:10px;
  border:1px solid var(--line);
  background:#0f1520;
  color:var(--text);
}
a.btn{display:inline-block;text-decoration:none; text-align:center}
textarea{min-height:80px;resize:vertical}
button{cursor:pointer}
button.primary, a.btn.primary{border-color:transparent;background:var(--accent);color:#06101a;font-weight:700}
button.ghost, a.btn.ghost{background:transparent}
button.danger, a.btn.danger{border-color:transparent;background:var(--danger);color:#18060a;font-weight:800}
hr{border:none;border-top:1px solid var(--line);margin:12px 0}
.kv{display:flex;justify-content:space-between;gap:12px}
.kv b{font-weight:700}
.muted{color:var(--muted)}
.big{font-size:22px;font-weight:900;letter-spacing:.5px}
.center{text-align:center}
.code{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace;font-size:12px;color:var(--muted);word-break:break-all}
.timer{font-variant-numeric:tabular-nums;font-size:40px;font-weight:900}
.badge{display:inline-block;padding:4px 10px;border:1px solid var(--line);border-radius:999px;font-size:12px;color:var(--muted)}
.inline-row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
.footer{padding:10px 4px;color:var(--muted);text-align:center}

/* Love Letter player screen: maximize vertical space */
body.ll-player-screen .header{display:none}
body.ll-player-screen .app{padding-top:10px}

.form-error{color:var(--danger);font-size:13px;line-height:1.4}
.form-error:empty{display:none}

/* Result highlight (winner=red, loser=blue) */
#view.result-win{background:rgba(255,90,106,.22);border-color:rgba(255,90,106,.55)}
#view.result-lose{background:rgba(77,163,255,.22);border-color:rgba(77,163,255,.55)}

/* Allow overlays (used by codenames turn frame) */
#view{position:relative}

/* QR should remain scannable on dark UI */
#qr,#qrImg{background:var(--text);padding:8px;border-radius:12px;display:inline-block}
#qrImg{max-width:240px;height:auto}

/* Codenames */
.cn-board{display:grid;gap:8px}
.cn-card{
  width:100%;
  padding:10px 8px;
  border-radius:12px;
  border:1px solid var(--line);
  background:var(--card);
  color:var(--text);
  min-height:44px;
  position:relative;
  -webkit-touch-callout:none;
  -webkit-user-select:none;
  user-select:none;
  touch-action:manipulation;
}
.cn-card:disabled{opacity:1}
.cn-word{display:block;font-weight:800;font-size:12px;word-break:break-word;line-height:1.1}
.cn-revealed.cn-red{background:rgba(255,90,106,.22);border-color:rgba(255,90,106,.55)}
.cn-revealed.cn-blue{background:rgba(77,163,255,.22);border-color:rgba(77,163,255,.55)}
.cn-revealed.cn-neutral{background:rgba(245,214,107,.22);border-color:rgba(245,214,107,.55)}
.cn-revealed.cn-assassin{background:var(--bg)}

/* Codenames: indicate opened cards (long, clear strike) */
.cn-revealed:not(.cn-keypreview) .cn-word{opacity:.72}
.cn-revealed:not(.cn-keypreview)::after{content:"";position:absolute;left:10px;right:10px;top:50%;height:3px;background:currentColor;opacity:.55;transform:translateY(-50%);border-radius:3px;pointer-events:none}

.cn-topline{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:nowrap}
.cn-topline>div{min-width:0}
.cn-me{font-weight:900;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.cn-role{color:var(--muted);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.cn-turn{white-space:nowrap;padding:4px 10px;border:1px solid var(--line);border-radius:999px;font-size:12px;color:var(--muted)}
.cn-turn-red{background:rgba(255,90,106,.12)}
.cn-turn-blue{background:rgba(77,163,255,.12)}
.cn-turn-active{background:var(--text);border-color:var(--text);color:var(--bg)}
.cn-turn-red.cn-turn-active{background:var(--text);border-color:var(--text)}
.cn-turn-blue.cn-turn-active{background:var(--text);border-color:var(--text)}

/* Codenames: emphasize only the acting player (frame) */
#view.cn-turn-actor::before{content:"";position:absolute;inset:-3px;border:3px solid var(--text);border-radius:12px;pointer-events:none}

.cn-clue-row{display:flex;gap:10px;align-items:center;flex-wrap:nowrap}
.cn-clue-row input{flex:1;min-width:0}
.cn-clue-num{max-width:90px}
.cn-clue-view,.cn-clue-left{color:var(--muted);font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.cn-clue-view b,.cn-clue-left b{color:var(--text)}

.cn-pending .cn-word{color:var(--ok)}

/* Love Letter (mobile-first, no-scroll) */
.ll-hand-wrap{display:flex;flex-direction:column;gap:10px}
.ll-hand{
  position:relative;
  width:min(340px, 90vw);
  margin:0 auto;
  aspect-ratio:3/4;
  touch-action:manipulation;
}
.ll-card{
  position:absolute;
  inset:0;
  border-radius:12px;
  border:1px solid var(--line);
  background:#0f1520;
  overflow:hidden;
  -webkit-user-select:none;
  user-select:none;
}
.ll-card-back{transform:translate(0,0) scale(.90);opacity:.85}
.ll-card-front{transform:translate(14px,16%) scale(.90)}
.ll-turn-waiting .ll-card-front{transform:translate(0,0) scale(.90);opacity:.85}
.ll-card-img{width:100%;height:100%;object-fit:contain;display:block}
.ll-hint{font-size:13px}

.ll-player{gap:8px}
.ll-player-name{margin-top:0}
.ll-topline{display:flex;gap:10px;align-items:center;justify-content:space-between;flex-wrap:nowrap}
.ll-topline .ll-status{font-weight:900;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}

.ll-status-card{max-width:calc(100% - 120px)}
.ll-player .ll-status-card{margin-right:auto}

body.ll-player-screen .ll-piles-box{position:fixed;top:4px;right:4px;z-index:10000}
.ll-piles-box{border:1px solid var(--line);border-radius:12px;padding:6px;background:#0f1520;display:flex;flex-direction:column;align-items:center;gap:6px}
.ll-piles-text{color:var(--muted);font-size:12px;white-space:nowrap}
.ll-piles-icon{width:88px;height:88px;object-fit:contain;border-radius:10px;border:1px solid var(--line);background:#0f1520}

.ll-grave-icon{width:22px;height:22px;object-fit:contain;vertical-align:-6px;display:inline-block;margin-left:6px;border-radius:6px;border:1px solid var(--line);background:#0f1520}

.ll-modal-card{width:min(320px, 80vw);margin:10px auto;aspect-ratio:3/4}
.ll-action-card{width:min(240px, 64vw);margin:8px auto;aspect-ratio:3/4}
.ll-reveal-card{width:min(300px, 76vw);margin:8px auto;aspect-ratio:3/4}
.ll-modal-name{font-weight:900;text-align:center;font-size:16px;margin:6px 0 0}
.ll-modal-actions{gap:16px}
.ll-modal-actions button{min-width:120px}
.ll-guess-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.ll-guess-grid button{width:100%}

.ll-overlay{position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;padding:16px}
.ll-overlay.ll-sheet{align-items:center}
.ll-overlay-backdrop{position:absolute;inset:0;background:rgba(0,0,0,.6)}
.ll-overlay-panel{position:relative;width:100%;max-width:520px;background:var(--card);border:1px solid var(--line);border-radius:12px;padding:14px;max-height:calc(100vh - 32px);overflow:auto}

.ll-compare-row{display:flex;gap:10px;justify-content:space-between;align-items:flex-start;margin-top:6px}
.ll-compare-col{flex:1;min-width:0}
.ll-compare-card{width:100%;aspect-ratio:3/4;max-width:180px;margin:6px auto 0}

/* Love Letter: turn emphasis */
#view.ll-turn-actor::before{content:"";position:absolute;inset:-4px;border:4px solid var(--text);border-radius:12px;pointer-events:none}
.ll-turn-waiting .ll-hand-wrap{filter:brightness(.72);opacity:.75}
.ll-turn-waiting .stack>.card{filter:brightness(.78);opacity:.82}

/* Love Letter: showdown */
.ll-showdown-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.ll-showdown-item{display:flex;flex-direction:column;gap:6px;align-items:center}
.ll-showdown-card{width:min(220px, 44vw);aspect-ratio:3/4}

/* Modal spacing tweaks */
.ll-overlay-panel .stack{gap:14px}
.ll-guess-grid{gap:14px}
